æ—Å–µ–º—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π C++17, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–µ–Ω –ø—Ä–∏–º–µ–Ω—è—Ç—å –∫–∞–∂–¥—ã–π —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫
–°–µ—Ä–≥–µ–π –®–∞–º–±–∏—Ä
–ú—ã –ø–æ–≥–æ–≤–æ—Ä–∏–º –æ –≤–æ—Å—å–º–∏ —É–¥–æ–±–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö, –∫–æ—Ç–æ—Ä—ã–µ –≤–ª–∏—è—é—Ç –Ω–∞ –≤–∞—à –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω—ã–π –∫–æ–¥. –ß–µ—Ç—ã—Ä–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–∞—Å–∞—é—Ç—Å—è —Å–∞–º–æ–≥–æ —è–∑—ã–∫–∞, –∞ –µ—â—ë —á–µ—Ç—ã—Ä–µ ‚Äî –µ–≥–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏.

–í–∞–º —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞ —Å—Ç–∞—Ç—å—è –î–µ—Å—è—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π C++11, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∂–¥—ã–π C++ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫

–ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏


–ù–µ–∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–º–µ—Ä—ã —è –±—Ä–∞–ª –∏–∑ –¥–æ–∫–ª–∞–¥–æ–≤ –Ω–∞ –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏—è—Ö Russian C++ User Group ‚Äî –∑–∞ —ç—Ç–æ –æ–≥—Ä–æ–º–Ω–æ–µ —Å–ø–∞—Å–∏–±–æ –µ—ë –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–∞–º –∏ –¥–æ–∫–ª–∞–¥—á–∏–∫–∞–º! –Ø –±—Ä–∞–ª –ø—Ä–∏–º–µ—Ä—ã –∏–∑:

–ê–Ω—Ç–æ–Ω –ü–æ–ª—É—Ö–∏–Ω. C++17 (C++ SIBERIA 2016)
–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –§–æ–∫–∏–Ω. C++17, –∫–æ—Ç–æ—Ä—ã–π –º—ã –∑–∞—Å–ª—É–∂–∏–ª–∏ (C++ SIBERIA 2017)

1. –î–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è –ø—Ä–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏–∏ (–∞–Ω–≥–ª. structural bindings)


–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—é –ø—Ä–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö: auto [a, b, c] = std::tuple(32, "hello"s, 13.9)
–≤–æ–∑–≤—Ä–∞—â–∞–π—Ç–µ –∏–∑ —Ñ—É–Ω–∫—Ü–∏–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏–ª–∏ –∫–æ—Ä—Ç–µ–∂ –≤–º–µ—Å—Ç–æ –ø—Ä–∏—Å–≤–∞–∏–≤–∞–Ω–∏—è out-–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

–£–¥–æ–±–Ω–æ –¥–µ–∫–æ–º–ø–æ–∑–∏—Ä–æ–≤–∞—Ç—å std::pair, std::tuple –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Å –ø–æ–º–æ—â—å—é –Ω–æ–≤–æ–≥–æ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞:

#include <string>

struct BookInfo
{
    std::string title; // In UTF-8
    int yearPublished = 0;
};

BookInfo readBookInfo();

int main()
{
    // –†–∞—Å–∫–ª–∞–¥—ã–≤–∞–µ–º –ø–æ–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ title –∏ year, —Ç–∏–ø –∫–æ—Ç–æ—Ä—ã—Ö –≤—ã–≤–µ–¥–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ 
    auto [title, year] = readBookInfo();
}

–í C++17 –µ—Å—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏–∏ –ø—Ä–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏–∏:

–Ω–µ–ª—å–∑—è —è–≤–Ω–æ —É–∫–∞–∑—ã–≤–∞—Ç—å —Ç–∏–ø—ã –¥–µ–∫–æ–º–ø–æ–∑–∏—Ä—É–µ–º—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
–Ω–µ–ª—å–∑—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–ª–æ–∂–µ–Ω–Ω—É—é –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—é –≤–∏–¥–∞ auto [title, [header, content]] = ...

–î–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è –ø—Ä–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏–∏ –≤ –ø—Ä–∏–Ω—Ü–∏–ø–µ –º–æ–∂–µ—Ç —Ä–∞—Å–∫–ª–∞–¥—ã–≤–∞—Ç—å –ª—é–±–æ–π –∫–ª–∞—Å—Å ‚Äî –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –æ–¥–∏–Ω —Ä–∞–∑ –Ω–∞–ø–∏—Å–∞—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫—É –ø—É—Ç—ë–º —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ tuple_element, tuple_size –∏ get. –ü–æ–¥—Ä–æ–±–Ω–µ–µ —á–∏—Ç–∞–π—Ç–µ –≤ —Å—Ç–∞—Ç—å–µ Adding C++17 structured bindings support to your classes (blog.tartanllama.xyz)

–î–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è –ø—Ä–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏–∏ —Ö–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö std::map<> –∏ std::unordered_map<> —Å–æ —Å—Ç–∞—Ä—ã–º –º–µ—Ç–æ–¥–æ–º .insert() –∏ –¥–≤—É–º—è –Ω–æ–≤—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏ :

–ú–µ—Ç–æ–¥ try_emplace –≤—ã–ø–æ–ª–Ω—è–µ—Ç –≤—Å—Ç–∞–≤–∫—É —Ç–æ–≥–¥–∞ –∏ —Ç–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞, –∫–æ–≥–¥–∞ –∑–∞–¥–∞–Ω–Ω–æ–≥–æ –∫–ª—é—á–∞ –µ—â—ë –Ω–µ—Ç –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
–ï—Å–ª–∏ –∑–∞–¥–∞–Ω–Ω—ã–π –∫–ª—é—á —É–∂–µ –µ—Å—Ç—å –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ, –Ω–∏—á–µ–≥–æ –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç: –≤ —á–∞—Å—Ç–Ω–æ—Å—Ç–∏, rvalue-–∑–Ω–∞—á–µ–Ω–∏—è –Ω–µ –ø–µ—Ä–µ–º–µ—â–∞—é—Ç—Å—è
–ú–µ—Ç–æ–¥ insert_or_assign –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ª–∏–±–æ –≤—Å—Ç–∞–≤–∫—É, –ª–∏–±–æ –ø—Ä–∏—Å–≤–∞–∏–≤–∞–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞

–ü—Ä–∏–º–µ—Ä –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏–∏ —Å try_emplace –∏ –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏–∏ key-value –ø—Ä–∏ –æ–±—Ö–æ–¥–µ map:

#include <string>
#include <map>
#include <cassert>
#include <iostream>

int main()
{
    std::map<std::string, std::string> map;
    auto [iterator1, succeed1] = map.try_emplace("key", "abc");
    auto [iterator2, succeed2] = map.try_emplace("key", "cde");
    auto [iterator3, succeed3] = map.try_emplace("another_key", "cde");

    assert(succeed1);
    assert(!succeed2);
    assert(succeed3);

    // –í—ã –º–æ–∂–µ—Ç–µ —Ä–∞—Å–∫–ª–∞–¥—ã–≤–∞—Ç—å key –∏ value –ø—Ä—è–º–æ –≤ range-based for
    for (auto&& [key, value] : map)
    {
        std::cout << key << ": " << value << "\n";
    }
}

2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–≤–æ–¥ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —à–∞–±–ª–æ–Ω–æ–≤


–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∞–≤–∏–ª–∞:

—Ñ—É–Ω–∫—Ü–∏–∏ –≤–∏–¥–∞ std::make_pair –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω—ã: —Å–º–µ–ª–æ –ø–∏—à–∏—Ç–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è std::pair{10, "hello"s}, –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä —Å–∞–º –≤—ã–≤–µ–¥–µ—Ç —Ç–∏–ø
—à–∞–±–ª–æ–Ω–Ω—ã–µ RAII –≤–∏–¥–∞ std::lock_guard<std::mutex> guard(mutex); —Å—Ç–∞–Ω—É—Ç –∫–æ—Ä–æ—á–µ: std::lock_guard guard(mutex);
—Ñ—É–Ω–∫—Ü–∏–∏ std::make_unique –∏ std::make_shared –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É –Ω—É–∂–Ω—ã

–í—ã –º–æ–∂–µ—Ç–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–≤–æ–∏ –ø–æ–¥—Å–∫–∞–∑–∫–∏ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤—ã–≤–æ–¥–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —à–∞–±–ª–æ–Ω–∞: —Å–º. Automatic_deduction_guides

–ò–Ω—Ç–µ—Ä–µ—Å–Ω–∞—è –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å: –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –∏–∑ initializer_list<> –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è –¥–ª—è —Å–ø–∏—Å–∫–∞ –∏–∑ –æ–¥–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞. –î–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö JSON –±–∏–±–ª–∏–æ—Ç–µ–∫ (—Ç–∞–∫–∏—Ö –∫–∞–∫ json_spirit) —ç—Ç–æ –º–æ–∂–µ—Ç –æ–∫–∞–∑–∞—Ç—å—Å—è —Ñ–∞—Ç–∞–ª—å–Ω—ã–º. –ù–µ –∏–≥—Ä–∞–π—Ç–µ—Å—å —Å —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ –∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏ STL!

#include <vector>
#include <type_traits>
#include <cassert>

int main()
{
    std::vector v{std::vector{1, 2}};

    // –≠—Ç–æ vector<int>, –∞ –Ω–µ vector<vector<int>>
    static_assert(std::is_same_v<std::vector<int>, decltype(v)>);

    // –†–∞–∑–º–µ—Ä —Ä–∞–≤–µ–Ω –¥–≤—É–º
    assert(v.size() == 2);
}

3. –û–±—ä—è–≤–ª–µ–Ω–∏–µ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤ –∏–º—ë–Ω


–ò–∑–±–µ–≥–∞–π—Ç–µ –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤ –∏–º—ë–Ω, –∞ –µ—Å–ª–∏ –Ω–µ –∏–∑–±–µ–∂–∞—Ç—å, —Ç–æ –æ–±—ä—è–≤–ª—è–π—Ç–µ –∏—Ö —Ç–∞–∫:

namespace product::account::details
{
    // ...–≤–∞—à–∏ –∫–ª–∞—Å—Å—ã –∏ —Ñ—É–Ω–∫—Ü–∏–∏...
}

4. –ê—Ç—Ä–∏–±—É—Ç—ã nodiscard, fallthrough, maybe_unused


–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∞–≤–∏–ª–∞:

–∑–∞–≤–µ—Ä—à–∞–π—Ç–µ –≤—Å–µ –±–ª–æ–∫–∏ case, –∫—Ä–æ–º–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ, –ª–∏–±–æ –∞—Ç—Ä–∏–±—É—Ç–æ–º [[fallthrough]], –ª–∏–±–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π break;
–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ [[nodiscard]] –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–π, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏—Ö –∫–æ–¥ –æ—à–∏–±–∫–∏ –∏–ª–∏ –≤–ª–∞–¥–µ—é—â–∏–π —É–∫–∞–∑–∞—Ç–µ–ª—å (–Ω–µ–≤–∞–∂–Ω–æ, —É–º–Ω—ã–π –∏–ª–∏ –Ω–µ—Ç)
–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ [[maybe_unused]] –¥–ª—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω—ã —Ç–æ–ª—å–∫–æ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ assert

–ë–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ –æ–± –∞—Ç—Ä–∏–±—É—Ç–∞—Ö —Ä–∞—Å—Å–∫–∞–∑–∞–Ω–æ –≤ —Å—Ç–∞—Ç—å–µ –ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏ –∏–∑ C++17. –ó–¥–µ—Å—å –±—É–¥—É—Ç –∫—Ä–∞—Ç–∫–∏–µ –≤—ã–¥–µ—Ä–∂–∫–∏.
–í C++ –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –¥–æ–±–∞–≤–ª—è—Ç—å break –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ case –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ switch, –∏ –æ–± —ç—Ç–æ–º –ª–µ–≥–∫–æ –∑–∞–±—ã—Ç—å –¥–∞–∂–µ –æ–ø—ã—Ç–Ω–æ–º—É —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É. –ù–∞ –ø–æ–º–æ—â—å –ø—Ä–∏—Ö–æ–¥–∏—Ç –∞—Ç—Ä–∏–±—É—Ç fallthrough, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –ø—Ä–∏–∫–ª–µ–∏—Ç—å –∫ –ø—É—Å—Ç–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏. –§–∞–∫—Ç–∏—á–µ—Å–∫–∏ –∞—Ç—Ä–∏–±—É—Ç –ø—Ä–∏–∫–ª–µ–∏–≤–∞–µ—Ç—Å—è –∫ case, —Å–ª–µ–¥—É—é—â–µ–º—É –∑–∞ –ø—É—Å—Ç–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π.

enum class option { A, B, C };

void choice(option value)
{
    switch (value)
    {
    case option::A:
        // ...
    case option::B: // warning: unannotated fall-through between
                    //          switch labels
        // ...
        [[fallthrough]];
    case option::C: // no warning
        // ...
        break;
    }
}

–ß—Ç–æ–±—ã –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞–º–∏ –∞—Ç—Ä–∏–±—É—Ç–∞, –≤ GCC –∏ Clang —Å–ª–µ–¥—É–µ—Ç –≤–∫–ª—é—á–∏—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ -Wimplicit-fallthrough. –ü–æ—Å–ª–µ –≤–∫–ª—é—á–µ–Ω–∏—è —ç—Ç–æ–π –æ–ø—Ü–∏–∏ –∫–∞–∂–¥—ã–π case, –Ω–µ –∏–º–µ—é—â–∏–π –∞—Ç—Ä–∏–±—É—Ç–∞ fallthrough, –±—É–¥–µ—Ç –ø–æ—Ä–æ–∂–¥–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ.

–í –ø—Ä–æ–µ–∫—Ç–∞—Ö —Å –≤—ã—Å–æ–∫–∏–º–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏ –∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –º–æ–≥—É—Ç –ø—Ä–∞–∫—Ç–∏–∫–æ–≤–∞—Ç—å –æ—Ç–∫–∞–∑ –æ—Ç –≤—ã–±—Ä–æ—Å–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π (–ø–æ –∫—Ä–∞–π–Ω–µ–π –º–µ—Ä–µ –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö). –í —Ç–∞–∫–∏—Ö —Å–ª—É—á–∞—è—Ö –æ–± –æ—à–∏–±–∫–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–æ–æ–±—â–∞–µ—Ç –∫–æ–¥ –≤–æ–∑–≤—Ä–∞—Ç–∞, –≤–æ–∑–≤—Ä–∞—â—ë–Ω–Ω—ã–π –∏–∑ —Ñ—É–Ω–∫—Ü–∏–∏. –û–¥–Ω–∞–∫–æ, –æ—á–µ–Ω—å –ª–µ–≥–∫–æ –∑–∞–±—ã—Ç—å –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —ç—Ç–æ—Ç –∫–æ–¥.

[[nodiscard]] std::unique_ptr<Bitmap> LoadArrowBitmap() { /* ... */ }

void foo()
{
    // warning: ignoring return value of function declared
    //          with warn_unused_result attribute
    LoadArrowBitmap();  
}

–ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–≤–æ–π –∫–ª–∞—Å—Å –æ—à–∏–±–æ–∫, —Ç–æ –≤—ã –º–æ–∂–µ—Ç–µ —É–∫–∞–∑–∞—Ç—å –∞—Ç—Ä–∏–±—É—Ç –µ–¥–∏–Ω–æ–∂–¥—ã –≤ –µ–≥–æ –æ–±—ä—è–≤–ª–µ–Ω–∏–∏.

class [[nodiscard]] error_code { /* ... */ };

error_code bar();

void foo()
{
    // warning: ignoring return value of function declared
    //          with warn_unused_result attribute
    bar();
}

–ò–Ω–æ–≥–¥–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç—ã —Å–æ–∑–¥–∞—é—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é, –∏—Å–ø–æ–ª—å–∑—É–µ–º—É—é —Ç–æ–ª—å–∫–æ –≤ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–π –≤–µ—Ä—Å–∏–∏ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–æ–¥–∞ –æ—à–∏–±–∫–∏ –≤—ã–∑–≤–∞–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏. –í–æ–∑–º–æ–∂–Ω–æ, —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –æ—à–∏–±–∫–∞ –¥–∏–∑–∞–π–Ω–∞ –∫–æ–¥–∞, –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Å–ª–µ–¥–æ–≤–∞–ª–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –≤—Å–µ–≥–¥–∞. –¢–µ–º –Ω–µ –º–µ–Ω–µ–µ:

// ! —Å—Ç–∞—Ä—ã–π –∫–æ–¥!
auto result = DoSystemCall();
(void)result; // –≥–∞—Å–∏–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ–± unused variable
assert(result >= 0);

// —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∫–æ–¥
[[maybe_unused]] auto result = DoSystemCall();
assert(result >= 0);

5. –ö–ª–∞—Å—Å string_view –¥–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤-—Å—Ç—Ä–æ–∫


–ü—Ä–∞–≤–∏–ª–∞:

–≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π –∏ –º–µ—Ç–æ–¥–æ–≤ –≤–º–µ—Å—Ç–æ const string& —Å—Ç–∞—Ä–∞–π—Ç–µ—Å—å –ø—Ä–∏–Ω–∏–º–∞—Ç—å –Ω–µ–≤–ª–∞–¥–µ—é—â–∏–π string_view –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é
–≤–æ–∑–≤—Ä–∞—â–∞–π—Ç–µ –∏–∑ —Ñ—É–Ω–∫—Ü–∏–π –∏ –º–µ—Ç–æ–¥–æ–≤ –≤–ª–∞–¥–µ—é—â–∏–π string, –∫–∞–∫ –∏ —Ä–∞–Ω—å—à–µ
–±—É–¥—å—Ç–µ –æ—Å—Ç–æ—Ä–æ–∂–Ω—ã —Å –≤–æ–∑–≤—Ä–∞—Ç–æ–º string_view –∏–∑ —Ñ—É–Ω–∫—Ü–∏–∏: —ç—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø—Ä–æ–±–ª–µ–º–µ –≤–∏—Å—è—á–∏—Ö —Å—Å—ã–ª–æ–∫ (–∞–Ω–≥–ª. dangling pointers)

–ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ —Ç–æ–º, –ø–æ—á–µ–º—É string_view –ª—É—á—à–µ –≤—Å–µ–≥–æ –ø—Ä–∏–º–µ–Ω—è—Ç—å —Ç–æ–ª—å–∫–æ –¥–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, —á–∏—Ç–∞–π—Ç–µ –≤ —Å—Ç–∞—Ç—å–µ std::string_view –∫–æ–Ω—Å—Ç—Ä—É–∏—Ä—É–µ—Ç—Å—è –∏–∑ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ —Å—Ç—Ä–æ–∫
–ö–ª–∞—Å—Å string_view —Ö–æ—Ä–æ—à —Ç–µ–º, —á—Ç–æ –æ–Ω –ª–µ–≥–∫–æ –∫–æ–Ω—Å—Ç—Ä—É–∏—Ä—É–µ—Ç—Å—è –∏ –∏–∑ std::string –∏ –∏–∑ const char* –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –≤—ã–¥–µ–ª–µ–Ω–∏—è –ø–∞–º—è—Ç–∏. –ê –µ—â—ë –æ–Ω –∏–º–µ–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫—É constexpr –∏ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å std::string. –ù–æ –µ—Å—Ç—å –º–∏–Ω—É—Å: –¥–ª—è string_view –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –Ω–∞–ª–∏—á–∏–µ –Ω—É–ª–µ–≤–æ–≥–æ —Å–∏–º–≤–æ–ª–∞ –Ω–∞ –∫–æ–Ω—Ü–µ.

6. –ö–ª–∞—Å—Å—ã optional –∏ variant


–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ optional<> –∏ variant<> –Ω–∞—Å—Ç–æ–ª—å–∫–æ —à–∏—Ä–æ–∫–æ, —á—Ç–æ —è –¥–∞–∂–µ –Ω–µ –±—É–¥—É –ø—ã—Ç–∞—Ç—å—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–ø–∏—Å–∞—Ç—å –∏—Ö –≤ —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ. –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∞–≤–∏–ª–∞:

–ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–π—Ç–µ optional<T> –≤–º–µ—Å—Ç–æ unique_ptr<T> –¥–ª—è –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏ –æ–±—ä–µ–∫—Ç–∞ T, –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ –∫–æ—Ç–æ—Ä–æ–≥–æ –∫–æ—Ä–æ—á–µ –≤—Ä–µ–º–µ–Ω–∏ –∂–∏–∑–Ω–∏ –≤–ª–∞–¥–µ–ª—å—Ü–∞
–¥–ª—è PIMPL –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ unique_ptr<Impl>, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ Impl —Å–∫—Ä—ã—Ç–æ –≤ —Ñ–∞–π–ª–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–ª–∞—Å—Å–∞
–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–∏–ø variant –≤–º–µ—Å—Ç–æ enum –∏–ª–∏ –ø–æ–ª–∏–º–æ—Ä—Ñ–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤ –≤ —Å–∏—Ç—É–∞—Ü–∏–∏, –∫–æ–≥–¥–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è, —Ç–∞–∫–∏–µ –∫–∞–∫ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ª–∏—Ü–µ–Ω–∑–∏–∏, –Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å –æ–ø–∏—Å–∞–Ω—ã –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞–º–∏ enum –∏–∑-–∑–∞ –Ω–∞–ª–∏—á–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ –∫–∞–∂–¥–æ–º –∏–∑ —Å–æ—Å—Ç–æ—è–Ω–∏–π
–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–∏–ø variant –≤–º–µ—Å—Ç–æ enum –≤ —Å–∏—Ç—É–∞—Ü–∏–∏, –∫–æ–≥–¥–∞ –¥–∞–Ω–Ω—ã–µ, —Ç–∞–∫–∏–µ –∫–∞–∫ –∫–æ–¥ –æ—à–∏–±–∫–∏ –≤ –∏—Å–∫–ª—é—á–µ–Ω–∏–∏, –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã –≤–æ –≤—Å–µ—Ö –≤–∞—Ä–∏–∞–Ω—Ç–∞—Ö, –∏ –Ω–µ–ø–æ–ª–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –¥–æ–ª–∂–Ω–∞ –ø—Ä–∏–≤–æ–¥–∏—Ç—å –∫ –æ—à–∏–±–∫–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏
–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–∏–ø variant –≤–º–µ—Å—Ç–æ any –≤–µ–∑–¥–µ, –≥–¥–µ —ç—Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ
optional –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏ –æ–±—ä–µ–∫—Ç–∞, –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ –∫–æ—Ç–æ—Ä–æ–≥–æ –∫–æ—Ä–æ—á–µ –≤—Ä–µ–º–µ–Ω–∏ –∂–∏–∑–Ω–∏ –≤–ª–∞–¥–µ–ª—å—Ü–∞
–Ω–µ –ø—Ä–∏–º–µ–Ω—è–π—Ç–µ optional –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫: –æ–Ω –Ω–µ –Ω–µ—Å—ë—Ç –Ω–∏–∫–∞–∫–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –æ—à–∏–±–∫–µ
–¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –∑–Ω–∞—á–µ–Ω–∏—è –ª–∏–±–æ –æ—à–∏–±–∫–∏ –º–æ–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å —Å–≤–æ–π –∫–ª–∞—Å—Å Expected<Value, Error>, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ boost::variant<...>
–∞ –º–æ–∂–Ω–æ –Ω–µ –ø–∏—Å–∞—Ç—å –∏ –≤–∑—è—Ç—å –≥–æ—Ç–æ–≤—ã–π: github.com/martinmoene/expected-lite

–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞ —Å optional:

// nullopt - —ç—Ç–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ç–∏–ø–∞ nullopt_t, –∫–æ—Ç–æ—Ä–æ–µ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç
//  –∑–Ω–∞—á–µ–Ω–∏–µ optional (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ nullptr –¥–ª—è —É–∫–∞–∑–∞—Ç–µ–ª–µ–π)
std::optional<int> optValue = std::nullopt;
// ... –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º optValue ...
// –∑–∞–±–∏—Ä–∞–µ–º –ª–∏–±–æ –∑–Ω–∞—á–µ–Ω–∏–µ, –ª–∏–±–æ -1
const int valueOrFallback = optValue.value_or(-1);

optional –∏–º–µ–µ—Ç operator* –∏ operator->, –∞ —Ç–∞–∫–∂–µ —É–¥–æ–±–Ω—ã–π –º–µ—Ç–æ–¥ .value_or(const T &defaultValue)
optional –∏–º–µ–µ—Ç –º–µ—Ç–æ–¥ value, –∫–æ—Ç–æ—Ä—ã–π, –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç operator*, –±—Ä–æ—Å–∞–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ std::bad_optional_access –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∑–Ω–∞—á–µ–Ω–∏—è
optional –∏–º–µ–µ—Ç –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã —Å—Ä–∞–≤–Ω–µ–Ω–∏—è ‚Äú==‚Äù, ‚Äú!=‚Äù, ‚Äú<‚Äù, ‚Äú<=‚Äù, ‚Äú>‚Äù, ‚Äú>=‚Äù, –ø—Ä–∏ —ç—Ç–æ–º std::nullopt –º–µ–Ω—å—à–µ –ª—é–±–æ–≥–æ –¥–æ–ø—É—Å—Ç–∏–º–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è
optional –∏–º–µ–µ—Ç –æ–ø–µ—Ä–∞—Ç–æ—Ä —è–≤–Ω–æ–≥–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –≤ bool

–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞ —Å variant: –∑–¥–µ—Å—å –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º variant –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –æ–¥–Ω–æ–≥–æ –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π –≤ —Å–ª—É—á–∞–µ, –∫–æ–≥–¥–∞ —Ä–∞–∑–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –º–æ–≥—É—Ç –∏–º–µ—Ç—å —Ä–∞–∑–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

struct AnonymousUserState
{
};

struct TrialUserState
{
    std::string userId;
    std::string username;
};

struct SubscribedUserState
{
    std::string userId;
    std::string username;
    Timestamp expirationDate;
    LicenseType licenceType;
};

using UserState = std::variant<
    AnonymousUserState,
    TrialUserState,
    SubscribedUserState
>;

–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ variant –≤ –µ–≥–æ –ø–æ–¥—Ö–æ–¥–µ –∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é –ø–∞–º—è—Ç–∏: –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ø–æ–ª—è—Ö –∑–Ω–∞—á–µ–Ω–∏—è —Ç–∏–ø–∞ variant –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –≤—ã–¥–µ–ª–µ–Ω–∏–π –ø–∞–º—è—Ç–∏. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç —Ä–∞–∑–º–µ—Ä —Ç–∏–ø–∞ variant –∑–∞–≤–∏—Å–∏–º—ã–º –æ—Ç —Ç–∏–ø–æ–≤, –≤—Ö–æ–¥—è—â–∏—Ö –≤ –µ–≥–æ —Å–æ—Å—Ç–∞–≤. –¢–∞–∫ –º–æ–∂–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Ç–∞–±–ª–∏—Ü–∞ —Ä–∞–∑–º–µ—Ä–æ–≤ –Ω–∞ 32-–±–∏—Ç–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞—Ö (–Ω–æ —ç—Ç–æ –Ω–µ—Ç–æ—á–Ω–æ):

–ò–ª–ª—é—Å—Ç—Ä–∞—Ü–∏—è

7. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏–∏ std::size, std::data, std::begin, std::end


–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ std::size –¥–ª—è –∏–∑–º–µ—Ä–µ–Ω–∏—è –¥–ª–∏–Ω—ã C-style –º–∞—Å—Å–∏–≤–∞
—ç—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –º–∞—Å—Å–∏–≤–∞–º–∏ –∏ —Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏ STL, –Ω–æ –≤—ã–¥–∞—Å—Ç –æ—à–∏–±–∫—É –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –ø–µ—Ä–µ–¥–∞—Ç—å –µ–π –æ–±—ã—á–Ω—ã–π —É–∫–∞–∑–∞—Ç–µ–ª—å
–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ std::data –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–∑–º–µ–Ω—è–µ–º–æ–≥–æ —É–∫–∞–∑–∞—Ç–µ–ª—è –Ω–∞—á–∞–ª–æ —Å—Ç—Ä–æ–∫–∏, –º–∞—Å—Å–∏–≤–∞ –∏–ª–∏ std::vector<>
—Ä–∞–Ω—å—à–µ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–∞–∫–æ–≥–æ —É–∫–∞–∑–∞—Ç–µ–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ &text[0], –Ω–æ –æ–Ω–æ –∏–º–µ–µ—Ç –Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –Ω–∞ –ø—É—Å—Ç—ã—Ö —Å—Ç—Ä–æ–∫–∞—Ö

–ú–æ–∂–µ—Ç –±—ã—Ç—å, –¥–ª—è –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–π —Å –±–∞–π—Ç–∞–º–∏ –ª—É—á—à–µ –æ–ø–∏—Ä–∞—Ç—å—Å—è –Ω–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫—É GSL (C++ Core Guidelines Support Library).

8. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ std::filesystem


–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∞–≤–∏–ª–∞:

–ø–µ—Ä–µ–¥–∞–≤–∞–π—Ç–µ std::filesystem::path –≤–º–µ—Å—Ç–æ —Å—Ç—Ä–æ–∫ –≤–æ –≤—Å–µ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–µ—Ç—Å—è –ø—É—Ç—å
–±—É–¥—å—Ç–µ –æ—Å—Ç–æ—Ä–æ–∂–Ω—ã —Å —Ñ—É–Ω–∫—Ü–∏–µ–π canonical: –≤–æ–∑–º–æ–∂–Ω–æ, –≤—ã –∏–º–µ–ª–∏ –≤–≤–∏–¥—É –º–µ—Ç–æ–¥ lexically_normal
canonical –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–∏–º–≤–æ–ª–∏—á–µ—Å–∫–∏–µ —Å—Å—ã–ª–∫–∏, –∞ lexically_normal ‚Äî –Ω–µ—Ç
canonical —Ç—Ä–µ–±—É–µ—Ç, —á—Ç–æ–±—ã –ø—É—Ç—å —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–ª, –∞ lexically_normal ‚Äî –Ω–µ—Ç
–Ω–∞ Windows –ø–æ–ø—ã—Ç–∫–∞ —Å–∫–ª–µ–∏—Ç—å –ø–æ—á—Ç–∏-—Å–ª–∏—à–∫–æ–º-–¥–ª–∏–Ω–Ω—ã–π –ø—É—Ç—å –∏ "..", –∞ –∑–∞—Ç–µ–º –ø—Ä–∏–º–µ–Ω–∏—Ç—å canonical –º–æ–∂–µ—Ç –∑–∞–∫–æ–Ω—á–∏—Ç—å—Å—è —Ñ–∏–∞—Å–∫–æ: Boost –∫–∏–Ω–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –∏–∑-–∑–∞ —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω–æ–≥–æ –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª—É
–±—É–¥—å—Ç–µ –æ—Å—Ç–æ—Ä–æ–∂–Ω—ã —Å —Ñ—É–Ω–∫—Ü–∏–µ–π relative: –≤–æ–∑–º–æ–∂–Ω–æ, –≤—ã –∏–º–µ–ª–∏ –≤–≤–∏–¥—É lexically_relative
—Å—Ç–∞—Ä–∞–π—Ç–µ—Å—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å noexcept-–≤–µ—Ä—Å–∏–∏ —Ñ—É–Ω–∫—Ü–∏–π (—Å –∫–æ–¥–æ–º –æ—à–∏–±–∫–∏), –µ—Å–ª–∏ –æ—à–∏–±–∫–∞ –¥–ª—è –≤–∞—Å –ø—Ä–∏–µ–º–ª–µ–º–∞
–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ noexcept –≤–µ—Ä—Å–∏—é —Ñ—É–Ω–∫—Ü–∏–∏ exists, –∏–Ω–∞—á–µ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–µ—Ç–µ–≤—ã—Ö –ø—É—Ç–µ–π!
–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ boost::filesystem

–ß–µ–º –ø–ª–æ—Ö boost::filesystem? –û–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è, —É –Ω–µ–≥–æ –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–æ–±–ª–µ–º –¥–∏–∑–∞–π–Ω–∞:

–≤ Boost –Ω–µ —Ä–µ—à–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ 2038 –≥–æ–¥–∞; —Ç–æ—á–Ω–µ–µ, —ç—Ç—É –∑–∞–¥–∞—á—É –ø–µ—Ä–µ–ª–æ–∂–∏–ª–∏ –Ω–∞ time_t, –Ω–æ –≤ Linux –æ–Ω –¥–æ —Å–∏—Ö –ø–æ—Ä 32-–±–∏—Ç–Ω—ã–π!
–Ω–∞ —Ç—É —Ç–µ–º—É –µ—Å—Ç—å –æ—Ç–ª–∏—á–Ω–∞—è —Å—Ç–∞—Ç—å—è 2038: –æ—Å—Ç–∞–ª—Å—è –≤—Å–µ–≥–æ 21 –≥–æ–¥
–≤ STL-–≤–µ—Ä—Å–∏–∏ filesystem –µ—Å—Ç—å –≤—Å–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–æ–¥–∏—Ä–æ–≤–∫–∞–º

–õ—é–±–æ–π –æ–ø—ã—Ç–Ω—ã–π –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç –∑–Ω–∞–µ—Ç –æ —Ä–∞–∑–Ω–∏—Ü–µ –≤ –æ–±—Ä–∞–±–æ—Ç–∫–µ –ø—É—Ç–µ–π –º–µ–∂–¥—É Windows –∏ UNIX-—Å–∏—Å—Ç–µ–º–∞–º–∏:

–≤ Windows –ø—É—Ç–∏ –ø—Ä–∏–Ω–∏–º–∞—é—Ç—Å—è –≤ –≤–∏–¥–µ UTF-16 —Å—Ç—Ä–æ–∫ (–∏–ª–∏ –¥–∞–∂–µ UCS-2 —Å—Ç—Ä–æ–∫, —Ç.–µ. —Å—É—Ä—Ä–æ–≥–∞—Ç–Ω—ã—Ö –ø–∞—Ä –≤ –ø—É—Ç—è—Ö –Ω–∞–¥–æ –∏–∑–±–µ–≥–∞—Ç—å!), —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π —Ç–∏–ø wchar_t –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç 2-–±–∞–π—Ç–Ω—ã–π —Å–∏–º–≤–æ–ª –≤ –∫–æ–¥–∏—Ä–æ–≤–∫–µ UTF-16, –∞ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–º –ø—É—Ç–µ–π —Å–ª—É–∂–∏—Ç –æ–±—Ä–∞—Ç–Ω—ã–π —Å–ª–µ—à ‚Äú\‚Äù
–≤ UNIX –ø—É—Ç–∏ –ø—Ä–∏–Ω–∏–º–∞—é—Ç—Å—è –≤ –≤–∏–¥–µ UTF-8 —Å—Ç—Ä–æ–∫, —Ä–µ–¥–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π wchar_t –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç 4-–±–∞–π—Ç–Ω—ã–π —Å–∏–º–≤–æ–ª –≤ –∫–æ–¥–∏—Ä–æ–≤–∫–µ UCS32, –∞ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–º –ø—É—Ç–µ–π —Å–ª—É–∂–∏—Ç –ø—Ä—è–º–æ–π —Å–ª–µ—à ‚Äú/‚Äù

–ö–æ–Ω–µ—á–Ω–æ –∂–µ filesystem –∞–±—Å—Ç—Ä–∞–≥–∏—Ä—É–µ—Ç—Å—è –æ—Ç –ø–æ–¥–æ–±–Ω—ã—Ö —Ä–∞–∑–ª–∏—á–∏–π –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ª–µ–≥–∫–æ —Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ —Å –ø–ª–∞—Ç—Ñ–æ—Ä–º–æ-–∑–∞–≤–∏—Å–∏–º—ã–º–∏ —Å—Ç—Ä–æ–∫–∞–º–∏, —Ç–∞–∫ –∏ —Å —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–º UTF-8:

–¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è UTF-8 –≤–µ—Ä—Å–∏–∏ –ø—É—Ç–∏ —Å–ª—É–∂–∏—Ç –º–µ—Ç–æ–¥ u8string
–¥–ª—è –∫–æ–Ω—Å—Ç—Ä—É–∏—Ä–æ–≤–∞–Ω–∏—è –ø—É—Ç–∏ –∏–∑ UTF-8 —Å—Ç—Ä–æ–∫–∏ —Å–ª—É–∂–∏—Ç —Å–≤–æ–±–æ–¥–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è u8path
–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä std::filesystem::path –∏–∑ std::string ‚Äî –Ω–∞ Windows –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä —Å—á–∏—Ç–∞–µ—Ç –≤—Ö–æ–¥–Ω–æ–π –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π –∫–æ–¥–∏—Ä–æ–≤–∫—É –û–°!

–ë–æ–Ω—É—Å–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ: –ø—Ä–µ–∫—Ä–∞—Ç–∏—Ç–µ –ø–µ—Ä–µ–∏–∑–æ–±—Ä–µ—Ç–∞—Ç—å clamp, int_to_string –∏ string_to_int


–§—É–Ω–∫—Ü–∏—è std::clamp –¥–æ–ø–æ–ª–Ω—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏ min –∏ max. –û–Ω–∞ –æ–±—Ä–µ–∑–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –∏ —Å–≤–µ—Ä—Ö—É, –∏ —Å–Ω–∏–∑—É. –ê–Ω–∞–ª–æ–≥–∏—á–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è boost::clamp –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –±–æ–ª–µ–µ —Ä–∞–Ω–Ω–∏—Ö –≤–µ—Ä—Å–∏—è—Ö C++.

–ü—Ä–∞–≤–∏–ª–æ "–Ω–µ –ø–µ—Ä–µ–∏–∑–æ–±—Ä–µ—Ç–∞–π—Ç–µ clamp" –º–æ–∂–Ω–æ –æ–±–æ–±—â–∏—Ç—å: –≤ –ª—é–±–æ–º –∫—Ä—É–ø–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ –∏–∑–±–µ–≥–∞–π—Ç–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –º–∞–ª–µ–Ω—å–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –≤—ã—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è –æ–∫—Ä—É–≥–ª–µ–Ω–∏–π, –æ–±—Ä–µ–∑–∞–Ω–∏–π –∑–Ω–∞—á–µ–Ω–∏–π –∏ —Ç.–ø. ‚Äî –ø—Ä–æ—Å—Ç–æ –æ–¥–∏–Ω —Ä–∞–∑ –¥–æ–±–∞–≤—å—Ç–µ —ç—Ç–æ –≤ —Å–≤–æ—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É.

–ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –∑–∞–¥–∞—á –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å—Ç—Ä–æ–∫. –£ –≤–∞—Å –µ—Å—Ç—å —Å–≤–æ—è –º–∞–ª–µ–Ω—å–∫–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Å—Ç—Ä–æ–∫ –∏ –ø–∞—Ä—Å–∏–Ω–≥–∞? –í –Ω–µ–π –µ—Å—Ç—å –ø–∞—Ä—Å–∏–Ω–≥ –∏–ª–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∏—Å–µ–ª? –ï—Å–ª–∏ –µ—Å—Ç—å, –∑–∞–º–µ–Ω–∏—Ç–µ —Å–≤–æ—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –Ω–∞ –≤—ã–∑–æ–≤—ã to_chars –∏ from_chars

–§—É–Ω–∫—Ü–∏–∏ to_chars –∏ from_chars –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫. –û–Ω–∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –ø–æ –¥–≤–∞ –∑–Ω–∞—á–µ–Ω–∏—è:

–ø–µ—Ä–≤–æ–µ –∏–º–µ–µ—Ç —Ç–∏–ø char* –∏–ª–∏ const char* —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ –∏ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –ø–µ—Ä–≤—ã–π code unit (—Ç.–µ. char –∏–ª–∏ wchar_t), –∫–æ—Ç–æ—Ä—ã–π –Ω–µ —É–¥–∞–ª–æ—Å—å –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å
–≤—Ç–æ—Ä–æ–µ –∏–º–µ–µ—Ç —Ç–∏–ø std::error_code –∏ —Å–æ–æ–±—â–∞–µ—Ç –ø–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –æ—à–∏–±–∫–µ, –ø—Ä–∏–≥–æ–¥–Ω—É—é –¥–ª—è –≤—ã–±—Ä–æ—Å–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏—è std::system_error

–ü–æ—Å–∫–æ–ª—å–∫—É –≤ –ø—Ä–∏–∫–ª–∞–¥–Ω–æ–º –∫–æ–¥–µ —Å–ø–æ—Å–æ–± —Ä–µ–∞–∫—Ü–∏–∏ –Ω–∞ –æ—à–∏–±–∫—É –º–æ–∂–µ—Ç —Ä–∞–∑–ª–∏—á–∞—Ç—å—Å—è, —Å–ª–µ–¥—É–µ—Ç –ø–æ–º–µ—â–∞—Ç—å –≤—ã–∑–æ–≤—ã to_chars –∏ from_chars –≤–Ω—É—Ç—Ä—å —Å–≤–æ–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ –∏ —É—Ç–∏–ª–∏—Ç–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤.

#include <utility>

// –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç —Å—Ç—Ä–æ–∫—É –≤ —á–∏—Å–ª–æ, –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 0
// (–≤ –æ—Ç–ª–∏—á–∏–∏ –æ—Ç atoi, —É –∫–æ—Ç–æ—Ä–æ–≥–æ –º–µ—Å—Ç–∞–º–∏ –µ—Å—Ç—å –Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ)
template<class T>
T atoi_17(std::string_view str)
{
    T res{};
    std::from_chars(str.data(), str.data() + str.size(), res);
    return res;
}   